# nginx-front.conf

# 기본 Nginx 프로세스 설정
worker_processes 1;

events {
    worker_connections 1024;
}

http {
    # MIME 타입 설정
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    # 파일 전송 관련 최적화 설정
    sendfile        on;
    keepalive_timeout 65;

    # 로그 파일 설정 (필요시)
    access_log  /var/log/nginx/access.log;
    error_log   /var/log/nginx/error.log;

    server {
        listen       80;
        server_name  localhost;  # 실제 도메인이 있으면 변경하세요.

        # 정적 파일이 위치한 디렉토리 (Dockerfile에서 COPY로 복사된 경로)
        root   /usr/share/nginx/html;
        index  index.html index.htm;

        # React 앱의 클라이언트 사이드 라우팅 지원:
        # 요청된 URI가 실제 파일이나 디렉토리로 존재하지 않으면, 
        # index.html을 반환하여 React 라우터가 클라이언트 사이드에서 라우팅하도록 함.
        location / {
            try_files $uri $uri/ /index.html;
        }

        # (선택) 에러 페이지 설정
        error_page 404 /404.html;
        location = /404.html {
            internal;
        }
    }
}
